# OBDH-ASW-Termina

### ğŸ§© Application Architecture

Keeping the focus on the main objective â€” **evaluating Termina as a language for programming critical systems** â€” a working prototype of the satellite's on-board data management software has been developed.

The application implements a system that communicates with the outside world via a UART serial interface. Through this connection, **telecommands** are received (i.e., commands sent from the ground), and **telemetry** is transmitted, which reports the internal state of the system. Both message types follow the protocol defined by the **Consultative Committee for Space Data Systems (CCSDS)**. Additionally, the system incorporates several services from the **ECSS-E-ST-70-41C** standard, known as **PUS (Packet Utilisation Services)**, which structure and standardize common functionalities in space systems.

![Application architecture diagram](docs/images/architecture_diagram_2.svg)

These capabilities are implemented across different system components represented in the diagram above. At the top left, the `uart_handler` receives telecommands via an interrupt (`irq_3`), while the `tm_channel` resource handles the transmission of telemetry.

To correctly process these messages, auxiliary modules have been developed to handle tasks such as encoding and decoding data according to the **CCSDS standard**. These modules, accessible system-wide, are grouped in the lower right-hand corner of the diagram.

The implemented **PUS services** cover several functional areas:
- Time management (`pus_service_9`)
- Housekeeping (`pus_service_3`)
- Fault detection, isolation, and recovery (FDIR: `pus_service_12`, `pus_service_5`, `pus_service_19`)
- Configuration parameter management (`pus_service_20`)

The data managed by these services are stored in the system's data pool, represented in the diagram by two structures â€” `u8_system_data_pool` and `u32_system_data_pool` â€” which allow handling variables of different types.

All these services act as **passive components**, exposing functionality that is used by the **tasks**, which are the active elements defining the system's behavior. Notably, the `icu_manager` task is responsible for managing telecommands. It directly executes those requiring immediate attention using the associated resource (`mng_tc_executor`), and delegates the rest to the `bkg_tc_executor` and `hk_fdir` tasks. The latter also periodically trigger housekeeping and FDIR actions based on timer events, making use of the corresponding PUS services.



### ğŸ“ Repository Structure

The repository is organized as follows:

- ğŸ“ **`app/`**: contains the `app.fin` file with the application deployment.
- ğŸ“ **`src/`**: contains the code developed in **Termina**.
  - ğŸ“ **`handlers/`**: class files for the *handlers*, which are Termina reactive elements.
  - ğŸ“ **`resources/`**: class files for the *resources*, which are Termina passive elements.
  - ğŸ“ **`service_libraries/`**: auxiliary modules supporting additional system functionalities.
  - ğŸ“ **`tasks/`**: class files for the *tasks*, which are also Termina reactive elements.
- ğŸ“ **`output/`**: contains the C code generated by the Termina transpiler.
- ğŸ§¾ **`termina.yaml`**: defines the transpilation process and execution platform configuration.


